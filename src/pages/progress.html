<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>夏季清凉服务挑战赛</title>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">
    
    <script>
        // 定义全局抽奖函数
        window.openLotteryGame = function() {
            console.log("抽奖函数被调用");
            // 显示抽奖弹窗
            const lotteryModal = document.getElementById('lotteryModal');
            if (!lotteryModal) {
                console.error("找不到lotteryModal元素");
                return;
            }
            
            lotteryModal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            const items = document.querySelectorAll('.lottery-item');
            const selectBtn = document.getElementById('selectPrizeBtn');
            
            // 重置所有格子状态
            items.forEach(item => {
                item.classList.remove('flashing', 'highlight', 'selected');
                item.onclick = null;
            });
            
            if (selectBtn) {
                selectBtn.classList.remove('visible');
            }
            
            // 开始闪烁动画
            let flashingIndex = 0;
            const flashingInterval = setInterval(() => {
                items.forEach(item => item.classList.remove('flashing'));
                items[flashingIndex].classList.add('flashing');
                flashingIndex = (flashingIndex + 1) % items.length;
            }, 200);
            
            // 3秒后停止闪烁，显示中奖结果
            setTimeout(() => {
                clearInterval(flashingInterval);
                items.forEach(item => item.classList.remove('flashing'));
                
                // 随机选择2-3个奖品
                const winCount = Math.random() > 0.5 ? 3 : 2;
                const winIndexes = [];
                
                while(winIndexes.length < winCount) {
                    const index = Math.floor(Math.random() * items.length);
                    if (!winIndexes.includes(index)) {
                        winIndexes.push(index);
                    }
                }
                
                // 高亮显示中奖奖品
                winIndexes.forEach(index => {
                    items[index].classList.add('highlight');
                    
                    // 添加点击事件
                    items[index].onclick = function() {
                        items.forEach(item => item.classList.remove('selected'));
                        this.classList.add('selected');
                        if (selectBtn) {
                            selectBtn.classList.add('visible');
                        }
                    };
                });
                
                // 添加选择按钮点击事件
                if (selectBtn) {
                    selectBtn.onclick = function() {
                        const selectedItem = document.querySelector('.lottery-item.selected');
                        if (selectedItem) {
                            const prizeName = selectedItem.dataset.prize;
                            const prizeValue = selectedItem.dataset.value;
                            
                            alert(`恭喜您获得 ${prizeName}：${prizeValue}！`);
                            lotteryModal.classList.remove('active');
                            document.body.style.overflow = '';
                        } else {
                            alert('请选择一个奖品');
                        }
                    };
                }
                
            }, 3000);
        };
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log("页面加载完成，初始化抽奖功能");
            
            // 为抽奖按钮添加事件
            const lotteryBtn = document.getElementById('lottery-btn');
            if (lotteryBtn) {
                lotteryBtn.addEventListener('click', window.openLotteryGame);
            }
            
            // 为模态框背景点击添加关闭事件
            const lotteryModal = document.getElementById('lotteryModal');
            if (lotteryModal) {
                lotteryModal.addEventListener('click', function(e) {
                    if (e.target === lotteryModal) {
                        lotteryModal.classList.remove('active');
                        document.body.style.overflow = '';
                    }
                });
            }
        });
    </script>
</head>
<body>
<style>
/* 调整主题颜色变量 */
:root {
  --didi-blue: #4E9DE3; /* 主要蓝色 */
  --didi-blue-dark: #3E8BD2; /* 深一点的蓝色，用于悬停等 */
  --didi-blue-light: #6AABED; /* 浅一点的蓝色 */
  --bg-gradient-start: #EFF7FF; /* 浅蓝色渐变起点 */
  --bg-gradient-end: #F5FAFF; /* 浅蓝色渐变终点 */
  --card-bg: #FFFFFF; /* 卡片背景 */
  --highlight-blue-bg: #F0F8FF; /* 高亮蓝色背景 */
  --highlight-blue-border: #C5E2FF; /* 高亮蓝色边框 */
  --text-primary: #333333; /* 主要文字颜色 */
  --text-secondary: #666666; /* 次要文字颜色 */
  --text-blue: #4E9DE3; /* 蓝色文字 */
}

/* 覆盖默认颜色 */
.bg-didi-orange {
  background-color: var(--didi-blue) !important;
}

.text-didi-orange {
  color: var(--didi-blue) !important;
}

/* 页面背景渐变 */
.bg-gray-50 {
  background: linear-gradient(135deg, var(--bg-gradient-start), var(--bg-gradient-end)) !important;
}

/* 卡片背景 */
.bg-white {
  background-color: var(--card-bg) !important;
}

/* 修复蓝色渐变 */
.bg-gradient-to-r.from-blue-50.to-blue-100 {
  background: linear-gradient(to right, #F0F8FF, #E6F4FF) !important;
  border-color: #C5E2FF !important;
}

/* 修复绿色渐变 */
.bg-gradient-to-r.from-green-50.to-green-100 {
  background: linear-gradient(to right, #F2FBF7, #E6F7EF) !important;
  border-color: #C5E8D7 !important;
}

/* 更新按钮样式 */
button.bg-didi-orange, .bg-didi-orange {
  background-color: var(--didi-blue) !important;
}

/* 按钮悬停效果 */
button.bg-didi-orange:hover {
  background-color: var(--didi-blue-dark) !important;
}

/* 状态标签 */
.text-yellow-600 {
  color: var(--didi-blue) !important;
}

.bg-yellow-50 {
  background-color: var(--highlight-blue-bg) !important;
}

.border-yellow-100 {
  border-color: var(--highlight-blue-border) !important;
}

/* "我的奖品"按钮 */
.my-prizes-badge {
  position: relative;
  background-color: var(--highlight-blue-bg);
  color: var(--didi-blue);
  padding: 4px 10px;
  border-radius: 16px;
  font-weight: 500;
  font-size: 12px;
  display: flex;
  align-items: center;
  transition: all 0.2s;
  border: 1px solid var(--highlight-blue-border);
}

.my-prizes-badge:active {
  transform: scale(0.96);
}

.my-prizes-badge i {
  margin-right: 4px;
}

/* 添加邀请模态框样式 */
.invite-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s, visibility 0.3s;
}

.invite-modal.active {
  opacity: 1;
  visibility: visible;
}

.invite-modal-content {
  background-color: white;
  border-radius: 12px;
  width: 90%;
  max-width: 320px;
  overflow: hidden;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  transform: translateY(20px);
  transition: transform 0.3s;
}

.invite-modal.active .invite-modal-content {
  transform: translateY(0);
}

.invite-option {
  display: flex;
  align-items: center;
  padding: 16px;
  border-bottom: 1px solid #f0f0f0;
  transition: background-color 0.2s;
}

.invite-option:active {
  background-color: #f9f9f9;
}

.invite-option i {
  font-size: 24px;
  margin-right: 12px;
}

.invite-option.wechat i {
  color: #07C160;
}

.invite-option.link i {
  color: var(--didi-blue);
}

.invite-option.poster i {
  color: var(--didi-blue);
}

/* 九宫格抽奖相关样式 */
.lottery-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s, visibility 0.3s;
}

.lottery-modal.active {
  opacity: 1;
  visibility: visible;
}

.lottery-grid {
  width: 300px;
  height: 300px;
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: repeat(3, 1fr);
  gap: 10px;
  padding: 15px;
  background: linear-gradient(135deg, var(--didi-blue-light), var(--didi-blue));
  border-radius: 12px;
  box-shadow: 0 8px 30px rgba(78, 157, 227, 0.3);
}

.lottery-item {
  background: #fff;
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 10px;
  transition: all 0.2s;
  position: relative;
  overflow: hidden;
  cursor: pointer;
}

.lottery-item.flashing {
  animation: flash 0.5s infinite alternate;
  box-shadow: 0 0 12px rgba(78, 157, 227, 0.8);
  border: 3px solid var(--didi-blue);
  transform: scale(1.05);
}

.lottery-item.highlight {
  background: #E6F4FF;
  border: 3px solid var(--didi-blue);
  transform: scale(1.08);
  box-shadow: 0 0 15px rgba(78, 157, 227, 0.85);
}

.lottery-item.selected {
  background: var(--didi-blue);
  border: 3px solid var(--didi-blue-light);
  box-shadow: 0 0 20px rgba(78, 157, 227, 0.9);
}

.lottery-item.selected i,
.lottery-item.selected p {
  color: white;
  font-weight: bold;
}

.lottery-item i {
  font-size: 24px;
  color: var(--didi-blue);
  margin-bottom: 5px;
}

.lottery-item p {
  font-size: 12px;
  color: #333;
  font-weight: 500;
  margin: 0;
}

.lottery-title {
  position: absolute;
  top: -50px;
  left: 0;
  right: 0;
  text-align: center;
  color: white;
  font-size: 18px;
  font-weight: bold;
}

.lottery-close {
  position: absolute;
  top: -50px;
  right: 0;
  color: white;
  font-size: 24px;
  cursor: pointer;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.2);
}

.lottery-footer {
  position: absolute;
  bottom: -70px;
  left: 0;
  right: 0;
  display: flex;
  justify-content: center;
}

.lottery-select-btn {
  background: var(--didi-blue);
  color: white;
  border: none;
  border-radius: 20px;
  padding: 8px 20px;
  font-size: 14px;
  font-weight: bold;
  box-shadow: 0 4px 12px rgba(78, 157, 227, 0.3);
  cursor: pointer;
  display: none;
}

.lottery-select-btn.visible {
  display: block;
}

@keyframes flash {
  0% {
    background: #fff;
    transform: scale(1);
  }
  100% {
    background: #E6F4FF;
    transform: scale(1.05);
  }
}

/* 邀请选项颜色 */
.invite-option.poster i {
  color: var(--didi-blue);
}

/* 圆角高亮指示点 */
.bg-didi-orange.rounded-full {
  background-color: var(--didi-blue) !important;
}

/* 进度条 */
.bg-didi-orange.h-2\.5 {
  background-color: var(--didi-blue) !important;
}

/* 轮播背景 */
.auto-carousel {
  animation: slide 9s infinite;
}

/* 所有控制用的复选框默认隐藏 */
.toggle-control {
  position: absolute;
  opacity: 0;
  z-index: -1;
}

/* 当复选框被选中时显示内容 */
#honor-toggle:checked ~ .honor-details {
  display: block;
}

#honor-toggle:checked ~ .honor-label .honor-icon {
  transform: rotate(180deg);
}

/* 默认显示详情内容，而不是隐藏 */
.honor-details {
  display: block;
}

/* 默认旋转图标 */
.honor-label .honor-icon {
  transform: rotate(180deg);
}

/* 任务展开/折叠控制 */
#tasks-toggle:checked ~ .hidden-tasks {
  display: block;
  margin-top: 0; /* 移除之前添加的上边距 */
}

#tasks-toggle:checked ~ .tasks-label .show-more {
  display: none;
}

#tasks-toggle:checked ~ .tasks-label .show-less {
  display: flex;
}

.hidden-tasks {
  display: none;
  margin-top: 0; /* 移除之前添加的上边距 */
}

.show-less {
  display: none;
}

/* 模态框样式 */
.prize-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s, visibility 0.3s;
}

.prize-modal.active {
  opacity: 1;
  visibility: visible;
}

.prize-modal-content {
  background-color: white;
  border-radius: 12px;
  width: 90%;
  max-width: 400px;
  max-height: 80vh;
  overflow: hidden;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  transform: translateY(20px);
  transition: transform 0.3s;
}

.prize-modal.active .prize-modal-content {
  transform: translateY(0);
}

.my-prizes-badge {
  position: relative;
  background-color: #FFF6F2;
  color: var(--didi-blue);
  padding: 4px 10px;
  border-radius: 16px;
  font-weight: 500;
  font-size: 12px;
  display: flex;
  align-items: center;
  transition: all 0.2s;
}

.my-prizes-badge:active {
  transform: scale(0.96);
}

.my-prizes-badge i {
  margin-right: 4px;
}

/* 添加邀请模态框样式 */
.invite-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s, visibility 0.3s;
}

.invite-modal.active {
  opacity: 1;
  visibility: visible;
}

.invite-modal-content {
  background-color: white;
  border-radius: 12px;
  width: 90%;
  max-width: 320px;
  overflow: hidden;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  transform: translateY(20px);
  transition: transform 0.3s;
}

.invite-modal.active .invite-modal-content {
  transform: translateY(0);
}

.invite-option {
  display: flex;
  align-items: center;
  padding: 16px;
  border-bottom: 1px solid #f0f0f0;
  transition: background-color 0.2s;
}

.invite-option:active {
  background-color: #f9f9f9;
}

.invite-option i {
  font-size: 24px;
  margin-right: 12px;
}

.invite-option.wechat i {
  color: #07C160;
}

.invite-option.link i {
  color: var(--didi-blue);
}

.invite-option.poster i {
  color: var(--didi-blue);
}

.text-green-600 {
  color: var(--didi-blue) !important;
}

.text-green-700 {
  color: var(--didi-blue) !important;
}

.bg-green-50 {
  background-color: var(--highlight-blue-bg) !important;
}

.border-green-100 {
  border-color: var(--highlight-blue-border) !important;
}

.bg-green-500 {
  background-color: var(--didi-blue) !important;
}

.w-1\.5.h-1\.5.rounded-full.bg-didi-orange {
  background-color: var(--didi-blue) !important;
}
</style>

<div class="h-full flex flex-col bg-gray-50">
    <!-- 顶部标题栏 -->
    <div class="bg-didi-orange h-24 w-full px-5 pt-6 pb-3 relative">
        <button onclick="window.navigateTo('/')" class="absolute top-6 left-4 text-white">
            <i class="ri-arrow-left-line text-2xl"></i>
        </button>
        <a href="javascript:void(0)" onclick="navigateTo('/rules')" class="absolute top-6 right-4 text-didi-blue bg-white bg-opacity-20 rounded-full p-1.5">
            <i class="ri-question-line text-xl"></i>
        </a>
        <div class="text-center text-white mt-1">
            <h1 class="text-xl font-bold">夏季清凉服务挑战赛</h1>
            <p class="text-sm mt-0.5 opacity-90">活动时间：2025.5.1-2025.8.31</p>
        </div>
    </div>

    <!-- 主体内容 -->
    <div class="flex-1 overflow-y-auto pb-6">
        <div class="px-4 py-3 space-y-4">
            <!-- 模块一：我的荣誉和终极大奖 -->
            <div class="bg-white rounded-xl p-4 border border-gray-100">
                <div class="flex justify-between items-center mb-3">
                    <h2 class="text-base font-medium text-gray-800">我的清凉服务等级</h2>
                    <span class="text-xs bg-green-50 text-green-700 px-2 py-1 rounded-full font-medium border border-green-100">优秀级别</span>
                </div>
                
                <!-- 荣誉值进度条 -->
                <div class="mb-3">
                    <div class="flex justify-between text-sm mb-1">
                        <span class="text-didi-orange font-medium">太棒了！继续保持！</span>
                        <span class="font-bold text-green-700">10/10分</span>
                    </div>
                    <div class="h-2.5 w-full bg-gray-100 rounded-full overflow-hidden">
                        <div class="bg-didi-orange h-2.5 rounded-full" style="width: 100%"></div>
                    </div>
                </div>
                
                <!-- 终极大奖展示 -->
                <div class="mb-3 bg-gray-50 p-3 rounded-lg border border-gray-200">
                    <div class="flex items-center">
                        <i class="ri-trophy-fill text-didi-orange text-xl mr-2"></i>
                        <h3 class="text-sm font-medium text-gray-800">保持优秀级别，有机会获得终极大奖！</h3>
                    </div>
                    <div class="mt-2">
                        <p class="text-xs text-gray-600 mb-2">活动结束时，您将在高级抽奖池中抽取以下奖励：</p>
                        
                        <style>
                        @keyframes slide {
                            0%, 30% { transform: translateX(0); }
                            33%, 63% { transform: translateX(-33.333%); }
                            66%, 97% { transform: translateX(-66.666%); }
                            100% { transform: translateX(0); }
                        }
                        .auto-carousel {
                            animation: slide 9s infinite;
                        }
                        </style>
                        
                        <!-- 奖品轮播 -->
                        <div class="relative overflow-hidden my-2">
                            <div class="flex w-[300%] auto-carousel">
                                <!-- 奖品1 -->
                                <div class="w-1/3 px-2">
                                    <div class="flex flex-col items-center justify-center py-1 bg-white rounded-lg border border-gray-200">
                                        <i class="ri-money-cny-circle-line text-didi-orange text-2xl mb-1"></i>
                                        <p class="font-medium text-gray-800 text-base">现金大奖（最高1000元）</p>
                                    </div>
                                </div>
                                <!-- 奖品2 -->
                                <div class="w-1/3 px-2">
                                    <div class="flex flex-col items-center justify-center py-1 bg-white rounded-lg border border-gray-200">
                                        <i class="ri-coupon-line text-didi-orange text-2xl mb-1"></i>
                                        <p class="font-medium text-gray-800 text-base">免佣卡兑换券（最高60天）</p>
                                    </div>
                                </div>
                                <!-- 奖品3 -->
                                <div class="w-1/3 px-2">
                                    <div class="flex flex-col items-center justify-center py-1 bg-white rounded-lg border border-gray-200">
                                        <i class="ri-star-line text-didi-orange text-2xl mb-1"></i>
                                        <p class="font-medium text-gray-800 text-base">服务分（最高20分）</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 指示点 -->
                        <div class="flex justify-center mt-1 mb-1">
                            <span class="w-1.5 h-1.5 rounded-full bg-didi-orange mx-1"></span>
                            <span class="w-1.5 h-1.5 rounded-full bg-gray-300 mx-1"></span>
                            <span class="w-1.5 h-1.5 rounded-full bg-gray-300 mx-1"></span>
                        </div>
                        
                        <p class="text-xs text-gray-500 text-center mt-1">*仅限维持"优秀"级别至活动结束的司机参与抽取</p>
                    </div>
                </div>
                
                <!-- 荣誉说明 - 使用纯CSS控制 -->
                <div class="bg-gray-50 rounded-lg p-3 mb-3">
                    <input type="checkbox" id="honor-toggle" class="toggle-control" checked>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <i class="ri-information-line text-lg mr-2 text-didi-orange"></i>
                            <p class="text-xs font-medium text-gray-700">您当前清凉值: <span class="font-bold text-didi-orange">10/10分</span></p>
                        </div>
                        <label for="honor-toggle" class="text-gray-500 honor-label">
                            <i class="ri-arrow-down-s-line honor-icon"></i>
                        </label>
                    </div>
                    
                    <div class="mt-2 honor-details">
                        <div class="space-y-2.5">
                            <div class="flex items-center p-2 bg-gradient-to-r from-green-50 to-green-100 rounded-lg border border-green-200">
                                <div class="w-5 h-5 rounded-full bg-green-500 flex items-center justify-center mr-2 flex-shrink-0">
                                    <i class="ri-trophy-line text-white text-xs"></i>
                                </div>
                                <div>
                                    <p class="text-xs font-medium text-gray-800">8-10分：<span class="text-green-600 font-bold">"优秀"级别</span></p>
                                    <p class="text-xs text-gray-600">可获高级抽奖池奖励，最高1000元现金</p>
                                </div>
                            </div>
                            
                            <div class="flex items-center p-2 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg border border-blue-200">
                                <div class="w-5 h-5 rounded-full bg-blue-500 flex items-center justify-center mr-2 flex-shrink-0">
                                    <i class="ri-medal-line text-white text-xs"></i>
                                </div>
                                <div>
                                    <p class="text-xs font-medium text-gray-800">6-8分：<span class="text-blue-600 font-bold">"良好"级别</span></p>
                                    <p class="text-xs text-gray-600">可获中级抽奖池奖励，最高500元现金</p>
                                </div>
                            </div>
                            
                            <div class="flex items-center p-2 bg-gradient-to-r from-gray-50 to-gray-100 rounded-lg border border-gray-200">
                                <div class="w-5 h-5 rounded-full bg-gray-500 flex items-center justify-center mr-2 flex-shrink-0">
                                    <i class="ri-star-line text-white text-xs"></i>
                                </div>
                                <div>
                                    <p class="text-xs font-medium text-gray-800">低于6分：<span class="text-gray-600 font-bold">"一般"级别</span></p>
                                    <p class="text-xs text-gray-600">仅可获初级抽奖池奖励，最高100元现金</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 差评计数 -->
                <div class="bg-gray-50 p-3 rounded-lg border border-gray-200 mb-3">
                    <div class="flex items-center mb-2">
                        <i class="ri-error-warning-line text-lg mr-2 text-didi-orange"></i>
                        <h3 class="text-sm font-medium text-gray-800">清凉值规则</h3>
                    </div>
                    
                    <div class="flex items-center justify-between py-1 border-b border-gray-200">
                        <div class="flex items-center">
                            <i class="ri-thumb-down-line mr-2 text-gray-600 text-sm"></i>
                            <span class="text-xs text-gray-600">每次空调相关差评，扣减2分</span>
                        </div>
                        <div class="flex items-center">
                            <span class="text-xs text-gray-600 mr-1">差评数:</span>
                            <span class="text-green-700 font-bold">0</span>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between pt-2">
                        <div class="flex flex-col">
                            <div class="flex items-center">
                                <i class="ri-car-line mr-2 text-gray-600 text-sm"></i>
                                <span class="text-xs text-gray-600">活动期间完单数不足60单</span>
                            </div>
                            <div class="text-xs text-gray-500 mt-1 ml-6">
                                活动结束时每差1单，扣减2分
                            </div>
                        </div>
                        <div class="flex items-center">
                            <div class="flex flex-col items-end">
                                <div class="flex items-center">
                                    <span class="text-green-700 text-sm font-medium">36/60</span>
                                    <span class="text-green-700 text-xs ml-0.5">单</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 模块二：我的抽奖机会 -->
            <div class="bg-white rounded-xl p-4 border border-gray-100">
                <div class="flex justify-between items-center mb-3">
                    <div class="flex items-center">
                        <i class="ri-gift-2-line text-didi-orange text-lg mr-2"></i>
                        <h2 class="text-base font-medium text-gray-800">我的抽奖机会</h2>
                    </div>
                    <button onclick="document.getElementById('myPrizesModal').classList.add('active'); document.body.style.overflow='hidden';" class="my-prizes-badge">
                        <i class="ri-award-line"></i>
                        <span>我的奖品</span>
                    </button>
                </div>
                
                <!-- 热门奖品展示 -->
                <div class="grid grid-cols-3 gap-2 mb-3">
                    <div class="bg-gray-50 p-2 rounded-lg flex flex-col items-center border border-gray-200">
                        <i class="ri-money-cny-circle-line text-didi-orange text-2xl mb-1"></i>
                        <p class="text-xs text-gray-600 text-center">现金红包</p>
                    </div>
                    <div class="bg-gray-50 p-2 rounded-lg flex flex-col items-center border border-gray-200">
                        <i class="ri-bar-chart-line text-didi-orange text-2xl mb-1"></i>
                        <p class="text-xs text-gray-600 text-center">服务分</p>
                    </div>
                    <div class="bg-gray-50 p-2 rounded-lg flex flex-col items-center border border-gray-200">
                        <i class="ri-coupon-line text-didi-orange text-2xl mb-1"></i>
                        <p class="text-xs text-gray-600 text-center">免佣卡</p>
                    </div>
                </div>

                <button onclick="
                    // 显示抽奖弹窗
                    var lotteryModal = document.getElementById('lotteryModal');
                    lotteryModal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    
                    // 获取所有格子
                    var items = document.querySelectorAll('.lottery-item');
                    var selectBtn = document.getElementById('selectPrizeBtn');
                    
                    // 重置状态
                    items.forEach(function(item) {
                        item.classList.remove('flashing', 'highlight', 'selected');
                        item.onclick = null;
                    });
                    selectBtn.classList.remove('visible');
                    
                    // 闪烁动画
                    var flashingIndex = 0;
                    var flashingInterval = setInterval(function() {
                        items.forEach(function(item) { 
                            item.classList.remove('flashing');
                        });
                        items[flashingIndex].classList.add('flashing');
                        flashingIndex = (flashingIndex + 1) % items.length;
                    }, 200);
                    
                    // 3秒后停止闪烁
                    setTimeout(function() {
                        clearInterval(flashingInterval);
                        items.forEach(function(item) {
                            item.classList.remove('flashing');
                        });
                        
                        // 随机选择奖品
                        var winCount = Math.random() > 0.5 ? 3 : 2;
                        var winIndexes = [];
                        
                        while(winIndexes.length < winCount) {
                            var index = Math.floor(Math.random() * items.length);
                            if (winIndexes.indexOf(index) === -1) {
                                winIndexes.push(index);
                            }
                        }
                        
                        // 高亮中奖
                        winIndexes.forEach(function(index) {
                            items[index].classList.add('highlight');
                            
                            // 点击事件
                            items[index].onclick = function() {
                                items.forEach(function(it) {
                                    it.classList.remove('selected');
                                });
                                this.classList.add('selected');
                                selectBtn.classList.add('visible');
                            };
                        });
                        
                        // 选择按钮事件
                        selectBtn.onclick = function() {
                            var selectedItem = document.querySelector('.lottery-item.selected');
                            if (selectedItem) {
                                var prizeName = selectedItem.getAttribute('data-prize');
                                var prizeValue = selectedItem.getAttribute('data-value');
                                
                                alert('恭喜您获得 ' + prizeName + '：' + prizeValue + '！');
                                lotteryModal.classList.remove('active');
                                document.body.style.overflow = '';
                            } else {
                                alert('请选择一个奖品');
                            }
                        };
                    }, 3000);
                " class="w-full py-3 rounded-lg bg-didi-orange text-white font-medium text-sm shadow-md flex items-center justify-center">
                    <i class="ri-gift-line mr-2"></i>
                    <span>立即抽奖 (2次机会)</span>
                </button>
            </div>

            <!-- 新模块：抽奖任务列表 -->
            <div class="bg-white rounded-xl p-4 border border-gray-100">
                <div class="flex justify-between items-center mb-3">
                    <div class="flex items-center">
                        <i class="ri-ticket-line text-didi-orange text-lg mr-2"></i>
                        <h2 class="text-base font-medium text-gray-800">抽奖任务</h2>
                    </div>
                </div>
            
                <!-- 任务列表 -->
                <div class="space-y-3">
                    <!-- 任务2: 邀请好友 -->
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center">
                                <div class="w-8 h-8 rounded-full bg-didi-orange flex items-center justify-center flex-shrink-0">
                                    <i class="ri-user-add-line text-white"></i>
                                </div>
                                <div class="ml-3">
                                    <h3 class="text-sm font-medium text-gray-800">邀请好友+1次</h3>
                                    <p class="text-xs text-gray-600 mt-0.5">每邀请1位司机参与活动</p>
                                    <p class="text-xs text-gray-600 mt-1">已邀请: <span class="text-didi-orange font-medium">2人</span></p>
                                </div>
                            </div>
                            <div>
                                <button onclick="document.getElementById('inviteModal').classList.add('active'); document.body.style.overflow='hidden';" class="text-xs bg-didi-orange text-white px-3 py-1.5 rounded-full">
                                    去邀请
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 任务1: 完成周期任务 -->
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center">
                                <div class="w-8 h-8 rounded-full bg-didi-orange flex items-center justify-center flex-shrink-0">
                                    <i class="ri-time-line text-white"></i>
                                </div>
                                <div class="ml-3">
                                    <h3 class="text-sm font-medium text-gray-800">完成周期任务+2次</h3>
                                    <p class="text-xs text-gray-600 mt-0.5">每周完成20单且0空调差评</p>
                                    <p class="text-xs text-gray-600 mt-1">已完成：<span class="text-didi-orange font-medium">15</span>单</p>
                                </div>
                            </div>
                            <span class="text-xs bg-yellow-50 text-yellow-600 px-2 py-1 rounded-full border border-yellow-100">进行中</span>
                        </div>
                    </div>
                    
                    <!-- 任务3-1: 连续达成2周 -->
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center">
                                <div class="w-8 h-8 rounded-full bg-didi-orange flex items-center justify-center flex-shrink-0">
                                    <i class="ri-medal-line text-white"></i>
                                </div>
                                <div class="ml-3">
                                    <h3 class="text-sm font-medium text-gray-800">连续达成2周+3次</h3>
                                    <p class="text-xs text-gray-600 mt-0.5">连续2周达成周期任务</p>
                                    <p class="text-xs text-gray-600 mt-1">已完成：<span class="text-didi-orange font-medium">1</span>周</p>
                                </div>
                            </div>
                            <span class="text-xs bg-yellow-50 text-yellow-600 px-2 py-1 rounded-full border border-yellow-100">进行中</span>
                        </div>
                    </div>
                
                    <!-- 任务3-2: 连续达成3周 -->
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center">
                                <div class="w-8 h-8 rounded-full bg-didi-orange flex items-center justify-center flex-shrink-0">
                                    <i class="ri-medal-line text-white"></i>
                                </div>
                                <div class="ml-3">
                                    <h3 class="text-sm font-medium text-gray-800">连续达成3周+4次</h3>
                                    <p class="text-xs text-gray-600 mt-0.5">连续3周达成周期任务</p>
                                </div>
                            </div>
                            <span class="text-xs bg-yellow-50 text-yellow-600 px-2 py-1 rounded-full border border-yellow-100">进行中</span>
                        </div>
                        <div class="mt-2 flex space-x-1.5">
                            <div class="w-6 h-6 rounded-full bg-didi-orange flex items-center justify-center text-xs text-white">1</div>
                            <div class="w-6 h-6 rounded-full bg-gray-300 flex items-center justify-center text-xs text-white">2</div>
                            <div class="w-6 h-6 rounded-full bg-gray-300 flex items-center justify-center text-xs text-white">3</div>
                        </div>
                    </div>
                    
                    <!-- 任务3-3: 连续达成4周 -->
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center">
                                <div class="w-8 h-8 rounded-full bg-didi-orange flex items-center justify-center flex-shrink-0">
                                    <i class="ri-trophy-line text-white"></i>
                                </div>
                                <div class="ml-3">
                                    <h3 class="text-sm font-medium text-gray-800">连续达成4周+5次</h3>
                                    <p class="text-xs text-gray-600 mt-0.5">连续4周达成周期任务</p>
                                </div>
                            </div>
                            <span class="text-xs bg-yellow-50 text-yellow-600 px-2 py-1 rounded-full border border-yellow-100">进行中</span>
                        </div>
                        <div class="mt-2 flex space-x-1.5">
                            <div class="w-6 h-6 rounded-full bg-didi-orange flex items-center justify-center text-xs text-white">1</div>
                            <div class="w-6 h-6 rounded-full bg-gray-300 flex items-center justify-center text-xs text-white">2</div>
                            <div class="w-6 h-6 rounded-full bg-gray-300 flex items-center justify-center text-xs text-white">3</div>
                            <div class="w-6 h-6 rounded-full bg-gray-300 flex items-center justify-center text-xs text-white">4</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 阶段抽奖池说明 -->
            <div class="bg-white rounded-xl p-4 border border-gray-100 mt-4 mb-5">
                <div class="flex items-center mb-3">
                    <i class="ri-trophy-line text-didi-orange text-lg mr-2"></i>
                    <h2 class="text-base font-medium text-gray-800">阶段抽奖池</h2>
                </div>
                
                <div class="space-y-3">
                    <!-- 初级抽奖池 -->
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center">
                                <div class="w-7 h-7 rounded-full bg-didi-orange flex items-center justify-center text-xs text-white mr-2">初</div>
                                <div>
                                    <h3 class="text-sm font-medium text-gray-800">初级抽奖池</h3>
                                    <p class="text-xs text-gray-600 mt-0.5">活动开始即可参与</p>
                                </div>
                            </div>
                            <span class="text-xs bg-green-50 text-green-600 px-2 py-1 rounded-full">已解锁</span>
                        </div>
                        <div class="mt-2 pl-9">
                            <p class="text-xs text-gray-600">1-5元红包、1天免佣卡、服务分+2</p>
                        </div>
                    </div>
                    
                    <!-- 中级抽奖池 -->
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center">
                                <div class="w-7 h-7 rounded-full bg-gray-500 flex items-center justify-center text-xs text-white mr-2">中</div>
                                <div>
                                    <h3 class="text-sm font-medium text-gray-800">中级抽奖池</h3>
                                    <p class="text-xs text-gray-600 mt-0.5">连续2周达成任务解锁</p>
                                </div>
                            </div>
                            <span class="text-xs bg-gray-200 text-gray-600 px-2 py-1 rounded-full">未解锁</span>
                        </div>
                        <div class="mt-2 pl-9">
                            <p class="text-xs text-gray-600">5-20元红包、7天免佣卡、服务分+5</p>
                        </div>
                    </div>
                    
                    <!-- 高级抽奖池 -->
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center">
                                <div class="w-7 h-7 rounded-full bg-gray-500 flex items-center justify-center text-xs text-white mr-2">高</div>
                                <div>
                                    <h3 class="text-sm font-medium text-gray-800">高级抽奖池</h3>
                                    <p class="text-xs text-gray-600 mt-0.5">连续4周达成任务解锁</p>
                                </div>
                            </div>
                            <span class="text-xs bg-gray-200 text-gray-600 px-2 py-1 rounded-full">未解锁</span>
                        </div>
                        <div class="mt-2 pl-9">
                            <p class="text-xs text-gray-600">20-100元红包、30天免佣卡、服务分+10</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 我的奖品模态框 -->
    <div id="myPrizesModal" class="prize-modal">
        <div class="prize-modal-content">
            <!-- 模态框头部 -->
            <div class="p-4 border-b border-gray-200 flex justify-between items-center">
                <h3 class="text-lg font-medium text-gray-800">我的奖品</h3>
                <button onclick="document.getElementById('myPrizesModal').classList.remove('active'); document.body.style.overflow='';" class="text-gray-500 p-1">
                    <i class="ri-close-line text-xl"></i>
                </button>
            </div>
            
            <!-- 模态框内容区 -->
            <div class="overflow-y-auto p-4" style="max-height: 60vh;">
                <div class="space-y-3">
                    <!-- 示例奖品1 -->
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200 flex justify-between items-center">
                        <div class="flex items-center">
                            <div class="w-10 h-10 rounded-full bg-red-100 flex items-center justify-center mr-3">
                                <i class="ri-money-cny-circle-line text-didi-orange text-xl"></i>
                            </div>
                            <div>
                                <h4 class="text-sm font-medium text-gray-800">现金红包</h4>
                                <p class="text-xs text-gray-500">2025.07.15 抽中</p>
                            </div>
                        </div>
                        <span class="text-didi-orange font-bold">￥15.88</span>
                    </div>
                    
                    <!-- 示例奖品2 -->
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200 flex justify-between items-center">
                        <div class="flex items-center">
                            <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center mr-3">
                                <i class="ri-coupon-line text-blue-500 text-xl"></i>
                            </div>
                            <div>
                                <h4 class="text-sm font-medium text-gray-800">免佣卡</h4>
                                <p class="text-xs text-gray-500">2025.07.08 抽中</p>
                            </div>
                        </div>
                        <span class="text-blue-500 font-bold">3天</span>
                    </div>
                    
                    <!-- 示例奖品3 -->
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200 flex justify-between items-center">
                        <div class="flex items-center">
                            <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center mr-3">
                                <i class="ri-bar-chart-line text-green-500 text-xl"></i>
                            </div>
                            <div>
                                <h4 class="text-sm font-medium text-gray-800">服务分</h4>
                                <p class="text-xs text-gray-500">2025.07.01 抽中</p>
                            </div>
                        </div>
                        <span class="text-green-500 font-bold">+5分</span>
                    </div>
                </div>
            </div>
            
            <!-- 模态框底部 -->
            <div class="p-4 border-t border-gray-200">
                <button onclick="document.getElementById('myPrizesModal').classList.remove('active'); document.body.style.overflow='';" class="w-full py-2.5 rounded-lg bg-didi-orange text-white font-medium">
                    关闭
                </button>
            </div>
        </div>
    </div>

    <!-- 添加九宫格抽奖弹窗 -->
    <div id="lotteryModal" class="lottery-modal">
        <div class="relative">
            <div class="lottery-title">幸运抽奖</div>
            <div class="lottery-close" onclick="document.getElementById('lotteryModal').classList.remove('active'); document.body.style.overflow='';">
                <i class="ri-close-line"></i>
            </div>
            
            <div class="lottery-grid" id="lotteryGrid">
                <!-- 九宫格奖品，9个格子 -->
                <div class="lottery-item" data-prize="现金红包" data-value="¥5">
                    <i class="ri-money-cny-circle-line"></i>
                    <p>¥5现金</p>
                </div>
                <div class="lottery-item" data-prize="免佣卡" data-value="1天">
                    <i class="ri-coupon-line"></i>
                    <p>1天免佣卡</p>
                </div>
                <div class="lottery-item" data-prize="现金红包" data-value="¥10">
                    <i class="ri-money-cny-circle-line"></i>
                    <p>¥10现金</p>
                </div>
                <div class="lottery-item" data-prize="服务分" data-value="+2分">
                    <i class="ri-bar-chart-line"></i>
                    <p>+2服务分</p>
                </div>
                <div class="lottery-item" data-prize="现金红包" data-value="¥30">
                    <i class="ri-money-cny-circle-line"></i>
                    <p>¥30现金</p>
                </div>
                <div class="lottery-item" data-prize="免佣卡" data-value="3天">
                    <i class="ri-coupon-line"></i>
                    <p>3天免佣卡</p>
                </div>
                <div class="lottery-item" data-prize="服务分" data-value="+5分">
                    <i class="ri-bar-chart-line"></i>
                    <p>+5服务分</p>
                </div>
                <div class="lottery-item" data-prize="现金红包" data-value="¥15">
                    <i class="ri-money-cny-circle-line"></i>
                    <p>¥15现金</p>
                </div>
                <div class="lottery-item" data-prize="免佣卡" data-value="7天">
                    <i class="ri-coupon-line"></i>
                    <p>7天免佣卡</p>
                </div>
            </div>
            
            <div class="lottery-footer">
                <button id="selectPrizeBtn" class="lottery-select-btn">选择奖品</button>
            </div>
        </div>
    </div>

    <!-- 添加邀请分享模态框 -->
    <div id="inviteModal" class="invite-modal">
        <div class="invite-modal-content">
            <!-- 模态框头部 -->
            <div class="p-4 border-b border-gray-200 flex justify-between items-center">
                <h3 class="text-lg font-medium text-gray-800">邀请好友</h3>
                <button onclick="document.getElementById('inviteModal').classList.remove('active'); document.body.style.overflow='';" class="text-gray-500 p-1">
                    <i class="ri-close-line text-xl"></i>
                </button>
            </div>
            
            <!-- 邀请选项 -->
            <div>
                <div class="invite-option wechat" onclick="shareToWechat()">
                    <i class="ri-wechat-fill"></i>
                    <div>
                        <p class="text-sm font-medium text-gray-800">微信邀请</p>
                        <p class="text-xs text-gray-500 mt-0.5">分享给微信好友或群聊</p>
                    </div>
                </div>
                
                <div class="invite-option link" onclick="copyInviteLink()">
                    <i class="ri-link"></i>
                    <div>
                        <p class="text-sm font-medium text-gray-800">复制链接</p>
                        <p class="text-xs text-gray-500 mt-0.5">复制邀请链接分享给好友</p>
                    </div>
                </div>
                
                <div class="invite-option poster" onclick="generatePoster()">
                    <i class="ri-image-line"></i>
                    <div>
                        <p class="text-sm font-medium text-gray-800">生成海报</p>
                        <p class="text-xs text-gray-500 mt-0.5">生成专属邀请海报</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// 我的奖品模态框控制函数
function togglePrizeModal() {
  const modal = document.getElementById('myPrizesModal');
  if (modal) {
    modal.classList.toggle('active');
    if (modal.classList.contains('active')) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = '';
    }
  }
}

// 页面加载完成后执行
document.addEventListener('DOMContentLoaded', function() {
  // 为背景点击添加关闭事件
  const modal = document.getElementById('myPrizesModal');
  if (modal) {
    modal.addEventListener('click', function(e) {
      if (e.target === modal) {
        togglePrizeModal();
      }
    });
  }
});

// 九宫格抽奖功能
function startLottery() {
    // 显示抽奖弹窗
    const lotteryModal = document.getElementById('lotteryModal');
    lotteryModal.classList.add('active');
    document.body.style.overflow = 'hidden';
    
    const items = document.querySelectorAll('.lottery-item');
    const selectBtn = document.getElementById('selectPrizeBtn');
    
    // 重置所有格子状态
    items.forEach(item => {
        item.classList.remove('flashing', 'highlight', 'selected');
        item.onclick = null;
    });
    
    selectBtn.classList.remove('visible');
    
    // 开始闪烁动画
    let flashingIndex = 0;
    const flashingInterval = setInterval(() => {
        items.forEach(item => item.classList.remove('flashing'));
        items[flashingIndex].classList.add('flashing');
        flashingIndex = (flashingIndex + 1) % items.length;
    }, 200);
    
    // 3秒后停止闪烁，显示中奖结果
    setTimeout(() => {
        clearInterval(flashingInterval);
        items.forEach(item => item.classList.remove('flashing'));
        
        // 随机选择2-3个奖品
        const winCount = Math.random() > 0.5 ? 3 : 2;
        const winIndexes = [];
        
        while(winIndexes.length < winCount) {
            const index = Math.floor(Math.random() * items.length);
            if (!winIndexes.includes(index)) {
                winIndexes.push(index);
            }
        }
        
        // 高亮显示中奖奖品
        winIndexes.forEach(index => {
            items[index].classList.add('highlight');
            
            // 添加点击事件
            items[index].onclick = function() {
                items.forEach(item => item.classList.remove('selected'));
                this.classList.add('selected');
                selectBtn.classList.add('visible');
            };
        });
        
        // 添加选择按钮点击事件
        selectBtn.onclick = function() {
            const selectedItem = document.querySelector('.lottery-item.selected');
            if (selectedItem) {
                const prizeName = selectedItem.dataset.prize;
                const prizeValue = selectedItem.dataset.value;
                
                alert(`恭喜您获得 ${prizeName}：${prizeValue}！`);
                lotteryModal.classList.remove('active');
                document.body.style.overflow = '';
            } else {
                alert('请选择一个奖品');
            }
        };
        
    }, 3000);
}

// 邀请分享功能
function shareToWechat() {
    alert('调用微信分享接口');
    document.getElementById('inviteModal').classList.remove('active');
    document.body.style.overflow = '';
}

function copyInviteLink() {
    // 模拟复制链接
    alert('邀请链接已复制到剪贴板');
    document.getElementById('inviteModal').classList.remove('active');
    document.body.style.overflow = '';
}

function generatePoster() {
    alert('正在生成邀请海报...');
    // 这里可以添加实际的海报生成和预览逻辑
    document.getElementById('inviteModal').classList.remove('active');
    document.body.style.overflow = '';
}
</script> 
</body>
</html> 